{% extends "Base.html" %}
{% block title %}Hist칩rico de Pedidos{% endblock %}
{% block content %}
<section class="max-w-6xl mx-auto px-4 py-6">

  <h1 class="text-xl font-bold mb-4">游닆 Hist칩rico de Pedidos</h1>

  <!-- Filtros -->
  <form method="get" class="flex gap-2 mb-6">
    <select name="status" class="border rounded px-2 py-1">
      <option value="todos">Todos</option>
      <option value="pendente" {% if status == "pendente" %}selected{% endif %}>Pendente</option>
      <option value="em_andamento" {% if status == "em_andamento" %}selected{% endif %}>Em andamento</option>
      <option value="finalizado" {% if status == "finalizado" %}selected{% endif %}>Finalizado</option>
    </select>

    <input type="text" name="q" placeholder="Buscar por mesa, atendente ou n췈 pedido"
           value="{{ busca }}" class="border rounded px-2 py-1 flex-1">

    <button type="submit" class="px-3 py-1 bg-neutral-900 text-white rounded">Filtrar</button>
  </form>

  <!-- Lista de pedidos -->
  <div class="space-y-4">
    {% for pedido in pedidos %}
      <div class="p-4 border rounded shadow">
        <p class="font-semibold">
          Pedido #{{ pedido.id }} - Mesa {{ pedido.mesa.numero }}
        </p>
        <p class="text-sm text-gray-500">
          Atendente: {{ pedido.atendente.username }} | {{ pedido.criado_em|date:"d/m/Y H:i" }}
        </p>
        <p>Status: <span class="font-medium">{{ pedido.status }}</span></p>

        <ul class="list-disc ml-5 mt-2">
          {% for item in pedido.itens.all %}
            <li>{{ item.quantidade }}x {{ item.item.nome }}</li>
          {% endfor %}
        </ul>
      </div>
    {% empty %}
      <p class="text-gray-500">Nenhum pedido encontrado.</p>
    {% endfor %}
  </div>

  <!-- Pagina칞칚o -->
  <div class="flex justify-between mt-6">
    {% if pedidos.has_previous %}
      <a href="?page={{ pedidos.previous_page_number }}&status={{ status }}&q={{ busca }}"
         class="px-3 py-1 border rounded">Anterior</a>
    {% endif %}

    <span>P치gina {{ pedidos.number }} de {{ pedidos.paginator.num_pages }}</span>

    {% if pedidos.has_next %}
      <a href="?page={{ pedidos.next_page_number }}&status={{ status }}&q={{ busca }}"
         class="px-3 py-1 border rounded">Pr칩xima</a>
    {% endif %}
  </div>

</section>
{% endblock %}
